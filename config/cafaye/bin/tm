#!/usr/bin/env bash
set -euo pipefail

if ! command -v tmux >/dev/null 2>&1; then
  echo "tmux is required for tm." >&2
  exit 1
fi

if ! command -v fzf >/dev/null 2>&1; then
  echo "fzf is required for tm." >&2
  exit 1
fi

target="$(
  tmux list-sessions -F '#{session_name}' 2>/dev/null | \
    fzf --height=40% --reverse --prompt="tmux session> "
)"

if [[ -z "${target:-}" ]]; then
  exit 0
fi

exec tmux attach -t "$target"
